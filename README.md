# Stock Price By Financials:  Создание модели для определения стоимости акции на основе финансовых показателей компании

## Введение

### Цель и основная идея работы

Идея данного проэкта является создания модели машинного обучения для определенния истинной стоимости компании. На рынке ценных бумаг часто можно заметить акции, цена которых значительно изменяется в течении непродолжительного временного промежутка, обычно это может быть связано с объективными и значительными изменениями в бизнесе компании, тем не менее не редки случаи когда акция компании получает черезмерную и необъективную популярность, или же наоборот, когда компания показывает хороший уровень отчетности, акции которой по каким то причинам не являются желланым приобретением у инвесторов, иногда такие акции являются идеальным вложением с перспективой на время, когда другие инвесторы так же заметят недооцененность акции. Поиск именно нахождение таких (недооценынных или же переоцененных) акций является основной целью данной работы.

### Тестирование модели
Тестирование и подбор лучших моделей будет проходить в способ "псевдо" инвестирования в акции (на срок в 1 год), цена которых модель посчитала необъективной, после чего программа учтёт изменение цен акций на следующий год и мы получим годовой доход этой модели. И в конце, записав результаты всех моделей во всех секторах, а так же определив из них 7 наилучших, создать список инвестиций каждой модели на 2024 год.

### Возможность реализации

   В реализации проета есть несколько неоднозначных моментов которые следует учитывать.

1. Основная цель обучении модели состоит в сопоставлении финансовых показателей компании с ценой ее акции, таким образом в лучшем случае модель в состоянии найти акцию, цена которой значительно отличается от других акций, при этом имея схожее с ними финансовое положение. Таким образом модель не в состоянии показать степень перегретости рынка и принимает цены акций на рынке как объективный показатель, пытаясь найти акции цена которых выделяется.
   
2. К большому сожалению сайт finance.yahoo предостовляет только 4 последних финансовых отчетностей, в связи с этим в проекте точность модели определяется только по краткосрочным инвестициям (1 год).  
   
3. Данные в проекте актуальны только на 2024 год, в последующем желательно обновить данные и возможно определить новые наилучшие модели.

## Выполнение проекта

### Сбор данных

1. Для обучения и тестирования моделей нужно получить доступ к ценам и финансовым отчетностям компаний. Для этого я использовал сервис finance.yahoo, а также библиотеку YFinance. Для начала стоило определить какие именно сектора и компании использовать для обучения, для этого я спарсил данные на сайте macrotrends, в итоге у нас есть тикеры компаний, которые згрупированы по секторам. (data_collect.py)

2. Теперь имея список секторов и тикеры всех компаний, можно начать формировать новые базы данных для отчетностей компаний использую yfinance. Так же необходимо написать несколько функций для отсеивания нерелевантных данных.(main.py).

###Обучение моделей

Для этого проекта я выбрал 7 моделей: ..... , для большей ефективности обучения я использовал optuna для подбора наилучших параметров моделей, ефективность модели определяется процентной разницей между предсказанной ценой акции и фактической.

###Предварительная обработка данных

Во время предварительной обработки данных у нас имеется набор из множества различных елементов финансовой отчетности, для обучения модели требуется одинаковая размерность данных, для этого нужно удалить те компании в данных которых много пробелов, а так же заполнить пропуски оставшихся, для 1 задачи я использовал 2 коэфициента (являются одними из гиперпараметров optuna) которые отвечали за допустимое количество пропусков в елементах фин. отчетности и в данных самих компаний, для заполнения оставшихся пропусков я использовал линейную регрессию.

Для поиска наиболее подходящих елементов фин. отчетности я использовал корреляцию между ними и ценой акции и отсортировал значение по модулю, количество наиболее коррелирующих данных определять гиперпараметр nlarge.

Наконец, можно приступать к обучению самих моделей и подбору наилучших гиперпараметров. После определения наиболее точных моделей можно использовать их для определения точности инвестирования.

### Псевдо инвестирование

## Итоги
